<!DOCTYPE html>
<html>
<head>
    <title>Login</title>
    <link rel="stylesheet" href="./assets/style.css">
</head>
<body onload="resize();" style="background-image: url('./assets/svg/background.svg');background-repeat: no-repeat;background-size: cover;cursor: default;">
    <!-- <form id="loginForm">
        <label for="username">Username</label>
        <input type="text" id="username" name="username" required>

        <label for="password">Password</label>
        <input type="password" id="password" name="password" required>

        <button type="submit">Login</button>
    </form> -->

    <!------------------------------------------------->
    <!--                    LOGIN                    -->
    <!------------------------------------------------->

    <div id="login" style="opacity:1;pointer-events: all;">
        <img    id="loginbox"               src="./assets/svg/loginbox.svg" alt="loginbox" class = "loginbox" width="600" height="729" style="position:absolute;left:660px;top:175px;">
        
        <div    id="loginUsernameText"      class="logintext" style="position:absolute;left:712px;top:363px;">Username</div>
        <img    id="loginUsernameIcon"      src="./assets/svg/usernameicon.svg" alt="unicon" class = "unicon" width="20" height="24" style="position:absolute;left:722px;top:393px;">
        <input  id="loginUsername"          type="text" placeholder="Type your username" style="position:absolute;left:753px;top:393px;">
        <img    id="loginUsernameUnderbar"  src="./assets/svg/underbar.svg" alt="underbar" class = "underbar" width="496" height="7" style="position:absolute;left:712px;top:427px;">

        <div    id="loginPasswordText"      class="logintext" style="position:absolute;left:712px;top:503px;">Password</div>
        <img    id="loginPasswordIcon"      src="./assets/svg/passwordicon.svg" alt="pwicon" class = "pwicon" width="20" height="24" style="position:absolute;left:722px;top:533px;">
        <input  id = "loginPassword"        type="password" placeholder="Type your password" style="position:absolute;left:753px;top:533px;">
        <img    id="loginPasswordUnderbar"  src="./assets/svg/underbar.svg" alt="underbar" class = "underbar" width="496" height="7" style="position:absolute;left:712px;top:567px;">

        <img    id="loginButton"            src="./assets/svg/loginbutton.svg" alt="loginbutton" class = "loginbutton" width="448" height="50" style="position:absolute;left:736px;top:644px;" onclick="auth('loginUsername', 'loginPassword')">

        <div    id="goToSignupText"         class="using" style="position:absolute;left:880px;top:763px;opacity:0.75;">Or sign up using</div>
        <div    id="goToSignUp"             class="using" style="position:absolute;left:919px;top:807px;" onclick="switchPage('login','signup')">SIGN UP</div>
        <div    id="credits"                class="usingalt" style="position:absolute;left:1775px;top:1080px;opacity:0.25">Login page design by Ethan Zhao 2023</div>
    </div>

    <!-------------------------------------------------->
    <!--                    SIGNUP                    -->
    <!-------------------------------------------------->

    <div id="signup" style="opacity:0;pointer-events: none;">
        <img    id="signupbox"              src="./assets/svg/signupbox.svg" alt="signupbox" class = "signupbox" width="600" height="885" style="position:absolute;left:660px;top:97px;">
        
        <div    id="signupFullnameText"     class="logintext" style="position:absolute;left:712px;top:298px;">Full Name</div>
        <img    id="signupFullnameIcon"     src="./assets/svg/usernameicon.svg" alt="unicon" class = "unicon" width="20" height="24" style="position:absolute;left:722px;top:328px;">
        <input  id="signupFullname"         type="text" placeholder="Type your full name" style="position:absolute;left:753px;top:328px;">
        <img    id="signupFullnameUnderbar" src="./assets/svg/underbar.svg" alt="underbar" class = "underbar" width="496" height="7" style="position:absolute;left:712px;top:362px;">
        
        <div    id="signupUsernameText"     class="logintext" style="position:absolute;left:712px;top:439px;">Username</div>
        <img    id="signupUsernameIcon"     src="./assets/svg/usernameicon.svg" alt="unicon" class = "unicon" width="20" height="24" style="position:absolute;left:722px;top:469px;">
        <input  id="signupUsername"         type="text" placeholder="Type your username" style="position:absolute;left:753px;top:469px;">
        <img    id="signupUsernameUnderbar" src="./assets/svg/underbar.svg" alt="underbar" class = "underbar" width="496" height="7" style="position:absolute;left:712px;top:502px;">
        
        <div    id="signupPasswordText"     class="logintext" style="position:absolute;left:712px;top:579px;">Password</div>
        <img    id="signupPasswordIcon"     src="./assets/svg/passwordicon.svg" alt="pwicon" class = "pwicon" width="20" height="24" style="position:absolute;left:722px;top:609px;">
        <input  id = "signupPassword"       type="password" placeholder="Type your username" style="position:absolute;left:753px;top:609px;">
        <img    id="signupPassordUnderbar"  src="./assets/svg/underbar.svg" alt="underbar" class = "underbar" width="496" height="7" style="position:absolute;left:712px;top:643px;">
        
        <img    id="signupButton"           src="./assets/svg/loginbutton.svg" alt="signupButton" class = "signupButton" width="448" height="50" style="position:absolute;left:736px;top:720px;" onclick="createUser('signupFullname','signupUsername','signupPassword')">
        
        <div    id="goToLoginText"          class="using" style="position:absolute;left:890px;top:842px;opacity:0.75;">Or log in using</div>
        <div    id="goToLogin"              class="using" style="position:absolute;left:926px;top:886px;" onclick="switchPage('signup','login')">LOG IN</div>
    </div>
</body>
<script>
function auth(unID, pwID) {
    username = document.getElementById(unID).value;
    password = document.getElementById(pwID).value;
    const body = {
        username: username,
        password: password
    };
    const read_options = {
        method: 'POST', // *GET, POST, PUT, DELETE, etc.
        mode: 'cors', // no-cors, *cors, same-origin
        cache: 'default', // *default, no-cache, reload, force-cache, only-if-cached
        body: JSON.stringify(body),
        credentials: 'omit', // include, *same-origin, omit
        headers: {
            'Content-Type': 'application/json'
        },
    };
    // fetch the data from API
    fetch("http://127.0.0.1:8570/api/leaderboard/auth", read_options)
        // response is a RESTful "promise" on any successful fetch
        .then(response => {
            // check for response errors
            if (response.status !== 200) {
                const errorMsg = 'Database read error: ' + response.status;
                return;
            }
            // valid response will have json data
            response.json().then(data => {
            if (data !== null) {
                document.cookie = "auth="+data;
                window.location.href = '/index.html';
            }
            else {
                console.log("invalid login credentials")
            }
        })
    })
    // catch fetch errors (ie ACCESS to server blocked)
    .catch(err => {
      console.error(err);
    });
}
function createUser(fnid, unid, pwid) {
    fullname = document.getElementById(fnid).value;
    username = document.getElementById(unid).value;
    password = document.getElementById(pwid).value;
    const body = {
        username: username,
        password: password,
        pointsEasy: 0,
        pointsMedium: 0,
        pointsHard: 0
    };
    const read_options = {
        method: 'POST', // *GET, POST, PUT, DELETE, etc.
        mode: 'cors', // no-cors, *cors, same-origin
        cache: 'default', // *default, no-cache, reload, force-cache, only-if-cached
        body: JSON.stringify(body),
        credentials: 'omit', // include, *same-origin, omit
        headers: {
            'Content-Type': 'application/json'
        },
    };
    // fetch the data from API
    fetch("http://127.0.0.1:8570/api/leaderboard/leaderboard", read_options)
        // response is a RESTful "promise" on any successful fetch
        .then(response => {
            // check for response errors
            if (response.status !== 200) {
                const errorMsg = 'Database read error: ' + response.status;
                return;
            }
            // valid response will have json data
            response.json().then(data => {
            if (data !== null) {
                window.location = "./index.html"
            }
            else {
                // display invalid creds
            }
        })
    })
    // catch fetch errors (ie ACCESS to server blocked)
    .catch(err => {
      console.error(err);
    });
    auth(unid, pwid)
}
function switchPage(current, page) {
    document.getElementById(current).style.opacity = "0";
    document.getElementById(current).style.pointerEvents = "none";
    document.getElementById(page).style.opacity = "1";
    document.getElementById(page).style.pointerEvents = "all";
}
</script>
<script>
function dynamic_TextPositioning(idName, originalLeft, originalTop, size) {
    var element = document.getElementById(idName);
    var element_Top = size * originalTop;
    element.style.top = element_Top + "px";
    var element_Left = size * originalLeft;
    element.style.left = element_Left + "px";
}
function dynamic_TextSize(className, originalSize, size) {
    var element_Font = size * originalSize;
    var elements = document.getElementsByClassName(className);
    for (var i = 0; i < elements.length; i++) {
        var element = elements[i];
        element.style.fontSize = element_Font + "px";
    }
}
function dynamic_TextSizeByID(idName, originalSize, size) {
    var element_Font = size * originalSize;
    var element = document.getElementById(idName);
    element.style.fontSize = element_Font + "px";
}
function dynamic_imgSize(idName, originalWidth, originalHeight, originalLeft, originalTop, size) {
    var element = document.getElementById(idName);
    var element_Height = size * originalHeight;
    element.style.height = element_Height + "px";
    var element_Width = size * originalWidth;
    element.style.width = element_Width + "px";
    var element_Top = size * originalTop;
    element.style.top = element_Top + "px";
    var element_Left = size * originalLeft;
    element.style.left = element_Left + "px";
}
window.onresize = resize;
function resize () {
    var current = window.innerWidth;
    var size = window.innerWidth/1920;
    //login
    dynamic_imgSize("loginbox", 600, 729, 660, 175, size);
    
    dynamic_TextPositioning('loginUsernameText', 712, 363, size);
    dynamic_imgSize('loginUsernameIcon', 20, 24, 722, 393, size);
    dynamic_TextPositioning('loginUsername', 753, 393, size);
    dynamic_TextSizeByID('loginUsername', 20, size);
    dynamic_imgSize('loginUsernameUnderbar', 496, 7, 712, 427, size);
    
    dynamic_TextPositioning('loginPasswordText', 712, 503, size);
    dynamic_imgSize('loginPasswordIcon', 20, 24, 722, 533, size);
    dynamic_TextPositioning('loginPassword', 753, 533, size);
    dynamic_TextSizeByID('loginPassword', 20, size);
    dynamic_imgSize('loginPasswordUnderbar', 496, 7, 712, 567, size);
    
    dynamic_imgSize('loginButton', 448, 50, 736, 644, size);
    
    dynamic_TextPositioning('goToSignupText', 880, 763, size);
    dynamic_TextPositioning('goToSignUp', 919, 807, size);
    dynamic_TextPositioning('credits', 1775, 1080, size);
    //signup
    dynamic_imgSize("signupbox", 600, 885, 660, 97, size);

    dynamic_TextPositioning('signupFullnameText', 712, 298, size);
    dynamic_imgSize('signupFullnameIcon', 20, 24, 722, 328, size);
    dynamic_TextPositioning('signupFullname', 753, 328, size);
    dynamic_TextSizeByID('signupFullname', 20, size);
    dynamic_imgSize('signupFullnameUnderbar', 496, 7, 712, 362, size);

    dynamic_TextPositioning('signupUsernameText', 712, 439, size);
    dynamic_imgSize('signupUsernameIcon', 20, 24, 722, 469, size);
    dynamic_TextPositioning('signupUsername', 753, 469, size);
    dynamic_TextSizeByID('signupUsername', 20, size);
    dynamic_imgSize('signupUsernameUnderbar', 496, 7, 712, 502, size);

    dynamic_TextPositioning('signupPasswordText', 712, 579, size);
    dynamic_imgSize('signupPasswordIcon', 20, 24, 722, 609, size);
    dynamic_TextPositioning('signupPassword', 753, 609, size);
    dynamic_TextSizeByID('signupPassword', 20, size);
    dynamic_imgSize('signupPassordUnderbar', 496, 7, 712, 643, size);

    dynamic_imgSize('signupButton', 448, 50, 736, 720, size);

    dynamic_TextPositioning('goToLoginText', 890, 842, size);
    dynamic_TextPositioning('goToLogin', 926, 886, size);

    // text
    dynamic_TextSize('logintext', 20, size);
    dynamic_TextSize('using', 20, size);
    dynamic_TextSize('usingalt', 7, size);

}
</script>
</html>
